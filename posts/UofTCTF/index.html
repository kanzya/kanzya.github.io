<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="UofTCTF 2024" /><meta name="author" content="kanon" /><meta property="og:locale" content="en" /><meta name="description" content="UofTCTF 2024" /><meta property="og:description" content="UofTCTF 2024" /><link rel="canonical" href="https://kanzya.github.io/posts/UofTCTF/" /><meta property="og:url" content="https://kanzya.github.io/posts/UofTCTF/" /><meta property="og:site_name" content="kanon" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2024-01-14T00:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="UofTCTF 2024" /><meta name="twitter:site" content="@_k4non" /><meta name="twitter:creator" content="@kanon" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"kanon"},"dateModified":"2024-03-22T19:18:25+09:00","datePublished":"2024-01-14T00:00:00+09:00","description":"UofTCTF 2024","headline":"UofTCTF 2024","mainEntityOfPage":{"@type":"WebPage","@id":"https://kanzya.github.io/posts/UofTCTF/"},"url":"https://kanzya.github.io/posts/UofTCTF/"}</script><title>UofTCTF 2024 | kanon</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="kanon"><meta name="application-name" content="kanon"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&family=Noto+Sans+JP:wght@400;600;700;900"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="https://raw.githubusercontent.com/kanzya/photo/main/image.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">kanon</a></div><div class="site-subtitle font-italic">just a person</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/kanzya" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/_k4non" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['pahc1h8a','s.okayama-u.ac.jp'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>UofTCTF 2024</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4 pb-5"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>UofTCTF 2024</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1705158000" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jan 14, 2024 </em> </span> <span> Updated <em class="" data-ts="1711102705" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Mar 22, 2024 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href=""></a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1808 words"> <em>10 min</em> read</span></div></div></div><div class="post-content"><h1 id="uoftctf-2024">UofTCTF 2024</h1><h2 id="export-grade-cipher-crypto-10-solve"><span class="mr-2">Export Grade Cipher [crypto 10 solve]</span><a href="#export-grade-cipher-crypto-10-solve" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="chall"><span class="mr-2">chall</span><a href="#chall" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">ast</span>
<span class="kn">import</span> <span class="nn">threading</span>
<span class="kn">from</span> <span class="nn">exportcipher</span> <span class="kn">import</span> <span class="o">*</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">flag</span> <span class="kn">import</span> <span class="n">FLAG</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">FLAG</span> <span class="o">=</span> <span class="s">"test{FLAG}"</span>

<span class="n">MAX_COUNT</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">TIMEOUT</span> <span class="o">=</span> <span class="mi">120</span> <span class="c1"># seconds
</span>
<span class="k">def</span> <span class="nf">input_bytes</span><span class="p">(</span><span class="n">display_msg</span><span class="p">):</span>
    <span class="n">m</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="n">display_msg</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">ast</span><span class="p">.</span><span class="n">literal_eval</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="c1"># might not be valid str or bytes literal but could still be valid input, so just encode it
</span>        <span class="k">pass</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">m</span><span class="p">.</span><span class="n">encode</span><span class="p">()</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">m</span>

<span class="k">def</span> <span class="nf">timeout_handler</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Time is up, you can throw out your work as the key changed."</span><span class="p">)</span>
    <span class="nb">exit</span><span class="p">()</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Initializing Export Grade Cipher..."</span><span class="p">)</span>
    <span class="n">key</span> <span class="o">=</span> <span class="nb">int</span><span class="p">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">urandom</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span><span class="s">"little"</span><span class="p">)</span>
    <span class="n">cipher</span> <span class="o">=</span> <span class="n">ExportGradeCipher</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"You may choose up to {} plaintext messages to encrypt."</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">MAX_COUNT</span><span class="p">))</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Recover the 40-bit key to get the flag."</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"You have {} seconds."</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">TIMEOUT</span><span class="p">))</span>
    <span class="c1"># enough time to crack a 40 bit key with the compute resources of a government
</span>    <span class="n">threading</span><span class="p">.</span><span class="n">Timer</span><span class="p">(</span><span class="n">TIMEOUT</span><span class="p">,</span> <span class="n">timeout_handler</span><span class="p">).</span><span class="n">start</span><span class="p">()</span>
    
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">MAX_COUNT</span><span class="p">:</span>
        <span class="n">pt</span> <span class="o">=</span> <span class="n">input_bytes</span><span class="p">(</span><span class="s">"[MSG {}] plaintext: "</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">pt</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">512</span><span class="p">:</span>
            <span class="c1"># don't allow excessively long messages
</span>            <span class="k">print</span><span class="p">(</span><span class="s">"Message Too Long!"</span><span class="p">)</span>
            <span class="k">continue</span>
        <span class="n">nonce</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">urandom</span><span class="p">(</span><span class="mi">256</span><span class="p">)</span>
        <span class="n">cipher</span><span class="p">.</span><span class="n">init_with_nonce</span><span class="p">(</span><span class="n">nonce</span><span class="p">)</span>
        <span class="n">ct</span> <span class="o">=</span> <span class="n">cipher</span><span class="p">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"[MSG {}] nonce: {}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">nonce</span><span class="p">))</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"[MSG {}] ciphertext: {}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">ct</span><span class="p">))</span>
        <span class="c1"># sanity check decryption
</span>        <span class="n">cipher</span><span class="p">.</span><span class="n">init_with_nonce</span><span class="p">(</span><span class="n">nonce</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">pt</span> <span class="o">==</span> <span class="n">cipher</span><span class="p">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">ct</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">recovered_key</span> <span class="o">=</span> <span class="n">ast</span><span class="p">.</span><span class="n">literal_eval</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s">"Recovered Key: "</span><span class="p">))</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">recovered_key</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">recovered_key</span> <span class="o">==</span> <span class="n">key</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"That is the key! Here is the flag: {}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">FLAG</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Wrong!"</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">os</span>

<span class="k">class</span> <span class="nc">LFSR</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seed</span><span class="p">,</span> <span class="n">taps</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">seed</span> <span class="o">!=</span> <span class="mi">0</span>
        <span class="k">assert</span> <span class="p">(</span><span class="n">seed</span> <span class="o">&gt;&gt;</span> <span class="n">size</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">taps</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="p">(</span><span class="n">size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">in</span> <span class="n">taps</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">seed</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">taps</span> <span class="o">=</span> <span class="n">taps</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">size</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">_shift</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">feedback</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">tap</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">taps</span><span class="p">:</span>
            <span class="n">feedback</span> <span class="o">^=</span> <span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">state</span> <span class="o">&gt;&gt;</span> <span class="n">tap</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">state</span> <span class="o">=</span> <span class="p">((</span><span class="bp">self</span><span class="p">.</span><span class="n">state</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">|</span> <span class="n">feedback</span><span class="p">)</span> <span class="o">&amp;</span> <span class="bp">self</span><span class="p">.</span><span class="n">mask</span>
    
    <span class="k">def</span> <span class="nf">next_byte</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">state</span> <span class="o">&amp;</span> <span class="mh">0xFF</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">_shift</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">val</span>


<span class="k">class</span> <span class="nc">ExportGradeCipher</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="c1"># 40 bit key
</span>        <span class="k">assert</span> <span class="p">(</span><span class="n">key</span> <span class="o">&gt;&gt;</span> <span class="mi">40</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">key</span> <span class="o">=</span> <span class="n">key</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">initialized</span> <span class="o">=</span> <span class="bp">False</span>
    
    <span class="k">def</span> <span class="nf">init_with_nonce</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nonce</span><span class="p">):</span>
        <span class="c1"># 256 byte nonce, nonce size isnt export controlled so hopefully this will compensate for the short key size
</span>        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">nonce</span><span class="p">)</span> <span class="o">==</span> <span class="mi">256</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">lfsr17</span> <span class="o">=</span> <span class="n">LFSR</span><span class="p">((</span><span class="bp">self</span><span class="p">.</span><span class="n">key</span> <span class="o">&amp;</span> <span class="mh">0xFFFF</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">),</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">16</span><span class="p">],</span> <span class="mi">17</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">lfsr32</span> <span class="o">=</span> <span class="n">LFSR</span><span class="p">(((</span><span class="bp">self</span><span class="p">.</span><span class="n">key</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">|</span> <span class="mh">0xAB</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFFFFFFFF</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">],</span> <span class="mi">32</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">S</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">256</span><span class="p">)]</span>
        <span class="c1"># Fisher-Yates shuffle S-table
</span>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span> 
            <span class="c1"># generate j s.t. 0 &lt;= j &lt;= i, has modulo bias but good luck exploiting that
</span>            <span class="n">j</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">lfsr17</span><span class="p">.</span><span class="n">next_byte</span><span class="p">()</span> <span class="o">^</span> <span class="bp">self</span><span class="p">.</span><span class="n">lfsr32</span><span class="p">.</span><span class="n">next_byte</span><span class="p">())</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="p">.</span><span class="n">S</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">S</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="bp">self</span><span class="p">.</span><span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># use nonce to scramble S-table some more
</span>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">256</span><span class="p">):</span>
            <span class="n">j</span> <span class="o">=</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="bp">self</span><span class="p">.</span><span class="n">lfsr17</span><span class="p">.</span><span class="n">next_byte</span><span class="p">()</span> <span class="o">^</span> <span class="bp">self</span><span class="p">.</span><span class="n">lfsr32</span><span class="p">.</span><span class="n">next_byte</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="p">.</span><span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">nonce</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">%</span> <span class="mi">256</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="p">.</span><span class="n">S</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">S</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="bp">self</span><span class="p">.</span><span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">S_inv</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">256</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">256</span><span class="p">):</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">S_inv</span><span class="p">[</span><span class="bp">self</span><span class="p">.</span><span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">i</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">initialized</span> <span class="o">=</span> <span class="bp">True</span>
    
    <span class="k">def</span> <span class="nf">_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">lfsr17</span><span class="p">.</span><span class="n">next_byte</span><span class="p">()</span> <span class="o">^</span> <span class="bp">self</span><span class="p">.</span><span class="n">lfsr32</span><span class="p">.</span><span class="n">next_byte</span><span class="p">()</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">S</span><span class="p">[</span><span class="n">v</span><span class="p">],</span> <span class="bp">self</span><span class="p">.</span><span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="p">.</span><span class="n">S</span><span class="p">[</span><span class="n">v</span><span class="p">]</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">S_inv</span><span class="p">[</span><span class="bp">self</span><span class="p">.</span><span class="n">S</span><span class="p">[</span><span class="n">v</span><span class="p">]]</span> <span class="o">=</span> <span class="n">v</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">S_inv</span><span class="p">[</span><span class="bp">self</span><span class="p">.</span><span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">i</span>
    
    <span class="k">def</span> <span class="nf">encrypt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="p">.</span><span class="n">initialized</span>
        <span class="n">ct</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">msg</span><span class="p">:</span>
            <span class="n">ct</span> <span class="o">+=</span> <span class="bp">self</span><span class="p">.</span><span class="n">S</span><span class="p">[</span><span class="n">v</span><span class="p">].</span><span class="n">to_bytes</span><span class="p">()</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">_update</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ct</span>
    
    <span class="k">def</span> <span class="nf">decrypt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ct</span><span class="p">):</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="p">.</span><span class="n">initialized</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">ct</span><span class="p">:</span>
            <span class="n">vo</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">S_inv</span><span class="p">[</span><span class="n">v</span><span class="p">]</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="n">vo</span><span class="p">.</span><span class="n">to_bytes</span><span class="p">()</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">_update</span><span class="p">(</span><span class="n">vo</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">msg</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">cipher</span> <span class="o">=</span> <span class="n">ExportGradeCipher</span><span class="p">(</span><span class="nb">int</span><span class="p">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">urandom</span><span class="p">(</span><span class="mi">5</span><span class="p">)))</span>
    <span class="n">nonce</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">urandom</span><span class="p">(</span><span class="mi">256</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"="</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Cipher Key: {}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">cipher</span><span class="p">.</span><span class="n">key</span><span class="p">))</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Nonce: {}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">nonce</span><span class="p">))</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="s">"ChatGPT: The Kerckhoffs' Principle, formulated by Auguste Kerckhoffs in the 19th century, is a fundamental concept in cryptography that states that the security of a cryptographic system should not rely on the secrecy of the algorithm, but rather on the secrecy of the key. In other words, a cryptosystem should remain secure even if all the details of the encryption algorithm, except for the key, are publicly known. This principle emphasizes the importance of key management in ensuring the confidentiality and integrity of encrypted data and promotes the development of encryption algorithms that can be openly analyzed and tested by the cryptographic community, making them more robust and trustworthy."</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"="</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Plaintext: {}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">msg</span><span class="p">))</span>
    <span class="n">cipher</span><span class="p">.</span><span class="n">init_with_nonce</span><span class="p">(</span><span class="n">nonce</span><span class="p">)</span>
    <span class="n">ct</span> <span class="o">=</span> <span class="n">cipher</span><span class="p">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">msg</span><span class="p">.</span><span class="n">encode</span><span class="p">())</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"="</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Ciphertext: {}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">ct</span><span class="p">))</span>
    <span class="n">cipher</span><span class="p">.</span><span class="n">init_with_nonce</span><span class="p">(</span><span class="n">nonce</span><span class="p">)</span>
    <span class="n">dec</span> <span class="o">=</span> <span class="n">cipher</span><span class="p">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">ct</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"="</span><span class="o">*</span><span class="mi">50</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Decrypted: {}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">dec</span><span class="p">))</span>
        <span class="k">assert</span> <span class="n">msg</span><span class="p">.</span><span class="n">encode</span><span class="p">()</span> <span class="o">==</span> <span class="n">dec</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"Decryption failed"</span><span class="p">)</span>
</pre></table></code></div></div><h3 id="solve"><span class="mr-2">solve</span><a href="#solve" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><h4 id="sumaary"><span class="mr-2">sumaary</span><a href="#sumaary" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>The class ExportGradeCipher is implemented in ExportGradeCipher.py.</p><ol><li><p>In this class, the state is initialized by the function <code class="language-plaintext highlighter-rouge">init_with_nonce</code> using key and nonce.</p><li><p>After that, the function <code class="language-plaintext highlighter-rouge">_update</code> constructs a nfsr(non linear shift register) of <code class="language-plaintext highlighter-rouge">lfsr17</code> and <code class="language-plaintext highlighter-rouge">lfsr32</code>, and appears to perform encryption using them.</p><li><p>In <code class="language-plaintext highlighter-rouge">encrypt</code>, after outputting the location of one character of msg in the S array as ct, the output of 256 bytes of nfsr and the location of one character of msg are swapped.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
    <span class="n">i</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">lfsr17</span><span class="p">.</span><span class="n">next_byte</span><span class="p">()</span> <span class="o">^</span> <span class="bp">self</span><span class="p">.</span><span class="n">lfsr32</span><span class="p">.</span><span class="n">next_byte</span><span class="p">()</span>
    <span class="bp">self</span><span class="p">.</span><span class="n">S</span><span class="p">[</span><span class="n">v</span><span class="p">],</span> <span class="bp">self</span><span class="p">.</span><span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="p">.</span><span class="n">S</span><span class="p">[</span><span class="n">v</span><span class="p">]</span>
       
<span class="k">def</span> <span class="nf">encrypt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
    <span class="k">assert</span> <span class="bp">self</span><span class="p">.</span><span class="n">initialized</span>
    <span class="n">ct</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">msg</span><span class="p">:</span>
        <span class="n">ct</span> <span class="o">+=</span> <span class="bp">self</span><span class="p">.</span><span class="n">S</span><span class="p">[</span><span class="n">v</span><span class="p">].</span><span class="n">to_bytes</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s">"little"</span><span class="p">)</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">_update</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ct</span>
</pre></table></code></div></div></ol><h4 id="cryptanisis"><span class="mr-2">cryptanisis</span><a href="#cryptanisis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Suppose we have an S array of length 4 and msg is b”\x00\x01\x02\x03”</p><div class="table-wrapper"><table><thead><tr><th>i<th>0<th>1<th>2<th>3<tbody><tr><td>S[i]<td>2<td>4<td>6<td>8</table></div><ol><li><p>If you follow the processing of the <code class="language-plaintext highlighter-rouge">encrypt</code> function in order, the first character is when <code class="language-plaintext highlighter-rouge">v=0</code> and the <code class="language-plaintext highlighter-rouge">ct</code> at that time is <code class="language-plaintext highlighter-rouge">ct[0]=2</code>.</p><li><p>The <code class="language-plaintext highlighter-rouge">self._update(v)</code> causes a swap <code class="language-plaintext highlighter-rouge">self.S[v], self.S[i] = self.S[i], self.S[v]</code>. We know that <code class="language-plaintext highlighter-rouge">v=0</code> here, so let’s assume <code class="language-plaintext highlighter-rouge">i=1</code>. Then the table transitions as follows.</p></ol><div class="table-wrapper"><table><thead><tr><th>i<th>0<th>1<th>2<th>3<tbody><tr><td>S[i]<td>4<td>2<td>6<td>8</table></div><ol><li>We see that v in the second week is <code class="language-plaintext highlighter-rouge">v=1</code> and that ct at that time is <code class="language-plaintext highlighter-rouge">ct[1]=2</code>. I want you to wait a moment. This time, the array S is all set to different values, so the same value <code class="language-plaintext highlighter-rouge">ct[0]=ct[1]=2</code> could be used for something.<ul><li><code class="language-plaintext highlighter-rouge">S[v], self.S[i] = self.S[i], self.S[v]</code> means that <code class="language-plaintext highlighter-rouge">v</code> can set itself and swap its value with the i-th value, and if the same value appears here, we know that it was swapped with the <code class="language-plaintext highlighter-rouge">i</code>-th value in the process at this time. So, at this point, we know the output <code class="language-plaintext highlighter-rouge">i</code> of the nfsr when the same value appears for the first time.</ul><li>The rest is a repeat of this.</ol><p>By the time you reach the end, you have obtained a certain amount of S array and nfsr output <code class="language-plaintext highlighter-rouge">i</code>. And considering that the nonce changes only <strong>S array</strong> in this setup, repeating the above process up to the upper limit will give us almost perfect nfsr output.</p><h4 id="solver"><span class="mr-2">solver</span><a href="#solver" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Therefore, now that we have obtained the output of nfsr, we can also reverse the initial state of lfsr32 by considering that lfsr17 is within the brute force range. At this point, checking whether the upper 2bytes are such that they are <code class="language-plaintext highlighter-rouge">0xAB</code> will reduce the number of candidate solutions.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="bp">self</span><span class="p">.</span><span class="n">lfsr32</span> <span class="o">=</span> <span class="n">LFSR</span><span class="p">(((</span><span class="bp">self</span><span class="p">.</span><span class="n">key</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">|</span> <span class="mh">0xAB</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFFFFFFFF</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">],</span> <span class="mi">32</span><span class="p">)</span>
</pre></table></code></div></div><p>Nevertheless, since about 30 candidates for the key remain, and considering that this cipher can only affect nonce and key, the key can be checked if the cipher is the same for that plaintext by performing the cipher again.</p><p>Thus, the following is my implementation. Note that I have used a matrix to speed up the lfsr.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">ast</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm</span>
<span class="kn">from</span> <span class="nn">exportcipher</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">class</span> <span class="nc">LFSR</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seed</span><span class="p">,</span> <span class="n">taps</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">seed</span> <span class="o">!=</span> <span class="mi">0</span>
        <span class="k">assert</span> <span class="p">(</span><span class="n">seed</span> <span class="o">&gt;&gt;</span> <span class="n">size</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">taps</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="p">(</span><span class="n">size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">in</span> <span class="n">taps</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">seed</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">size</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">taps</span> <span class="o">=</span> <span class="n">taps</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">size</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">mat</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="n">size</span><span class="p">,</span><span class="n">size</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">mat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">taps</span><span class="p">:</span>    
            <span class="bp">self</span><span class="p">.</span><span class="n">mat</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">state_vec</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="p">),[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">bin</span><span class="p">(</span><span class="n">seed</span><span class="p">)[</span><span class="mi">2</span><span class="p">:].</span><span class="n">zfill</span><span class="p">(</span><span class="n">size</span><span class="p">)])</span>
        
    <span class="k">def</span> <span class="nf">_shift</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">feedback</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">tap</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">.</span><span class="n">taps</span><span class="p">:</span>
            <span class="n">feedback</span> <span class="o">^^=</span> <span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">state</span> <span class="o">&gt;&gt;</span> <span class="n">tap</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">state</span> <span class="o">=</span> <span class="p">((</span><span class="bp">self</span><span class="p">.</span><span class="n">state</span> <span class="o">&lt;&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">|</span> <span class="n">feedback</span><span class="p">)</span> <span class="o">&amp;</span> <span class="bp">self</span><span class="p">.</span><span class="n">mask</span>
        
    <span class="k">def</span> <span class="nf">next_byte</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">state</span> <span class="o">&amp;</span> <span class="mh">0xFF</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">_shift</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">val</span>
            
    <span class="k">def</span> <span class="nf">_shift_mat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
        <span class="n">state_vec</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">mat</span><span class="o">^</span><span class="p">(</span><span class="mi">8</span><span class="o">*</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="p">.</span><span class="n">state_vec</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="s">""</span><span class="p">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">state_vec</span><span class="p">)[</span><span class="o">-</span><span class="mi">8</span><span class="p">:]]),</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">after_255_256_next_byte</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">val1</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">_shift_mat</span><span class="p">(</span><span class="mi">255</span><span class="o">+</span><span class="mi">256</span><span class="p">)</span>
        <span class="n">val2</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">_shift_mat</span><span class="p">(</span><span class="mi">256</span><span class="o">+</span><span class="mi">256</span><span class="p">)</span>
        <span class="n">val3</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">_shift_mat</span><span class="p">(</span><span class="mi">257</span><span class="o">+</span><span class="mi">256</span><span class="p">)</span>
        <span class="n">val4</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">_shift_mat</span><span class="p">(</span><span class="mi">258</span><span class="o">+</span><span class="mi">256</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">bytes</span><span class="p">([</span><span class="n">val1</span><span class="p">,</span><span class="n">val2</span><span class="p">,</span><span class="n">val3</span><span class="p">,</span><span class="n">val4</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">check</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vec</span><span class="p">):</span>
        <span class="n">vec</span> <span class="o">=</span> <span class="n">vector</span><span class="p">(</span><span class="n">GF</span><span class="p">(</span><span class="mi">2</span><span class="p">),[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">bin</span><span class="p">(</span><span class="n">vec</span><span class="p">[</span><span class="mi">0</span><span class="p">])[</span><span class="mi">2</span><span class="p">:].</span><span class="n">zfill</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="o">+</span><span class="nb">bin</span><span class="p">(</span><span class="n">vec</span><span class="p">[</span><span class="mi">1</span><span class="p">])[</span><span class="mi">2</span><span class="p">:].</span><span class="n">zfill</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="o">+</span><span class="nb">bin</span><span class="p">(</span><span class="n">vec</span><span class="p">[</span><span class="mi">2</span><span class="p">])[</span><span class="mi">2</span><span class="p">:].</span><span class="n">zfill</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="o">+</span><span class="nb">bin</span><span class="p">(</span><span class="n">vec</span><span class="p">[</span><span class="mi">3</span><span class="p">])[</span><span class="mi">2</span><span class="p">:].</span><span class="n">zfill</span><span class="p">(</span><span class="mi">8</span><span class="p">)])</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">inv_mat</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">mat</span><span class="o">^</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">inv_mat</span><span class="o">^</span><span class="p">(</span><span class="mi">8</span><span class="o">*</span><span class="mi">514</span><span class="p">)</span><span class="o">*</span><span class="n">vec</span><span class="p">)[:</span><span class="mi">8</span><span class="p">]</span> <span class="o">==</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">bin</span><span class="p">(</span><span class="mh">0xab</span><span class="p">)[</span><span class="mi">2</span><span class="p">:].</span><span class="n">zfill</span><span class="p">(</span><span class="mi">8</span><span class="p">)]:</span>
            <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="s">""</span><span class="p">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">inv_mat</span><span class="o">^</span><span class="p">(</span><span class="mi">8</span><span class="o">*</span><span class="mi">514</span><span class="p">)</span><span class="o">*</span><span class="n">vec</span><span class="p">)[</span><span class="mi">8</span><span class="p">:]]),</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">False</span>

<span class="k">def</span> <span class="nf">bxor</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">):</span> <span class="k">return</span> <span class="nb">bytes</span><span class="p">([</span><span class="n">_a</span><span class="o">^^</span><span class="n">_b</span> <span class="k">for</span> <span class="n">_a</span><span class="p">,</span><span class="n">_b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)])</span>

<span class="n">lfsr17s</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">lfsr32s</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">256</span><span class="o">**</span><span class="mi">2</span><span class="p">)):</span>
    <span class="n">lfsr17</span> <span class="o">=</span> <span class="n">LFSR</span><span class="p">((</span><span class="n">key</span> <span class="o">&amp;</span> <span class="mh">0xFFFF</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">),</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">16</span><span class="p">],</span> <span class="mi">17</span><span class="p">)</span>
    <span class="n">lfsr17s</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">lfsr17</span><span class="p">.</span><span class="n">after_255_256_next_byte</span><span class="p">())</span>

<span class="n">io</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s">"0.cloud.chals.io"</span><span class="p">,</span><span class="s">"23753"</span><span class="p">)</span>
<span class="c1"># io = process(["python3","chal.py"])
</span><span class="n">CNT</span> <span class="o">=</span> <span class="mi">256</span>
<span class="n">lfsr</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">CNT</span><span class="p">)]</span>
<span class="n">pt</span> <span class="o">=</span> <span class="p">[(</span><span class="n">i</span><span class="p">)</span><span class="o">%</span><span class="mi">256</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">CNT</span><span class="p">)]</span>

<span class="k">for</span> <span class="n">__</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">)):</span>
    <span class="n">random</span><span class="p">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span>
    <span class="n">io</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s">": "</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="n">pt</span><span class="p">)).</span><span class="n">encode</span><span class="p">())</span>
    <span class="n">nonce</span> <span class="o">=</span> <span class="n">ast</span><span class="p">.</span><span class="n">literal_eval</span><span class="p">(</span><span class="n">io</span><span class="p">.</span><span class="n">recvline</span><span class="p">().</span><span class="n">decode</span><span class="p">().</span><span class="n">split</span><span class="p">(</span><span class="s">"nonce: "</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">ct</span> <span class="o">=</span> <span class="n">ast</span><span class="p">.</span><span class="n">literal_eval</span><span class="p">(</span><span class="n">io</span><span class="p">.</span><span class="n">recvline</span><span class="p">().</span><span class="n">decode</span><span class="p">().</span><span class="n">split</span><span class="p">(</span><span class="s">"ciphertext: "</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">S</span>    <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">256</span><span class="p">)]</span>
    <span class="k">print</span><span class="p">(</span><span class="n">lfsr</span><span class="p">.</span><span class="n">count</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">CNT</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ct</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="n">S</span><span class="p">:</span>
            <span class="n">S</span><span class="p">[</span><span class="n">pt</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">ct</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">lfsr</span><span class="p">[</span><span class="n">ct</span><span class="p">[:</span><span class="n">i</span><span class="p">].</span><span class="n">index</span><span class="p">(</span><span class="n">ct</span><span class="p">[</span><span class="n">i</span><span class="p">])]</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">lfsr</span><span class="p">[</span><span class="n">ct</span><span class="p">[:</span><span class="n">i</span><span class="p">].</span><span class="n">index</span><span class="p">(</span><span class="n">ct</span><span class="p">[</span><span class="n">i</span><span class="p">])]</span> <span class="o">=</span> <span class="n">pt</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">S</span><span class="p">[</span><span class="n">pt</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">ct</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">S</span><span class="p">[</span><span class="n">S</span><span class="p">.</span><span class="n">index</span><span class="p">(</span><span class="n">ct</span><span class="p">[</span><span class="n">i</span><span class="p">])]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>


<span class="n">lfsr32</span> <span class="o">=</span> <span class="n">LFSR</span><span class="p">(((</span><span class="mh">0x123456</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">|</span> <span class="mh">0xAB</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFFFFFFFF</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">],</span> <span class="mi">32</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">256</span><span class="o">**</span><span class="mi">2</span><span class="p">)):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">lfsr32</span><span class="p">.</span><span class="n">check</span><span class="p">(</span><span class="n">bxor</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="n">lfsr</span><span class="p">[:</span><span class="mi">4</span><span class="p">]),</span><span class="n">lfsr17s</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
    <span class="k">if</span> <span class="n">a</span> <span class="o">!=</span> <span class="bp">False</span><span class="p">:</span>
        <span class="n">key1</span> <span class="o">=</span> <span class="n">i</span>
        <span class="n">key2</span> <span class="o">=</span> <span class="n">a</span>
        <span class="n">key</span> <span class="o">=</span> <span class="n">key1</span> <span class="o">+</span> <span class="p">(</span><span class="n">key2</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span>
        <span class="n">cipher</span> <span class="o">=</span> <span class="n">ExportGradeCipher</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="n">cipher</span><span class="p">.</span><span class="n">init_with_nonce</span><span class="p">(</span><span class="n">nonce</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ct</span> <span class="o">==</span> <span class="n">cipher</span><span class="p">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">pt</span><span class="p">):</span>
            <span class="n">io</span><span class="p">.</span><span class="n">sendlineafter</span><span class="p">(</span><span class="sa">b</span><span class="s">": "</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
            <span class="n">io</span><span class="p">.</span><span class="n">interactive</span><span class="p">()</span>
            <span class="nb">exit</span><span class="p">()</span>
<span class="c1"># uoftctf{wH0_w0u1D_h4ve_7houGHt_l0ng_nONceS_CAnt_S4ve_w3ak_KeYS}
</span></pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/writeup/'>writeup</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/writeup/" class="post-tag no-text-decoration" >writeup</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=UofTCTF+2024+-+kanon&url=https%3A%2F%2Fkanzya.github.io%2Fposts%2FUofTCTF%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=UofTCTF+2024+-+kanon&u=https%3A%2F%2Fkanzya.github.io%2Fposts%2FUofTCTF%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fkanzya.github.io%2Fposts%2FUofTCTF%2F&text=UofTCTF+2024+-+kanon" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/CPCTF-writeup/">CPCTF 2023 writeup</a><li><a href="/posts/zer0ptsCTF-writeup/">zer0pts 2023 writeup</a><li><a href="/posts/DEFCON/">DEF CON31参加記</a><li><a href="/posts/(copy)/">十月初週のupsolve</a><li><a href="/posts/">十月初週のupsolve</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/writeup/">writeup</a> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/cryptography/">cryptography</a> <a class="post-tag" href="/tags/advent-calendar/">advent_calendar</a> <a class="post-tag" href="/tags/def-con31/">DEF CON31</a> <a class="post-tag" href="/tags/tech/">tech</a> <a class="post-tag" href="/tags/university/">university</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/CPCTF-writeup/"><div class="card-body"> <em class="small" data-ts="1676732400" data-df="ll" > Feb 19, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>CPCTF 2023 writeup</h3><div class="text-muted small"><p> CPCTF なんか空き時間見つけて参加してました。面白かったです simple chall from Crypto.Util.number import inverse, bytes_to_long, getPrime from flag import flag class complex_over_p: &quot;&quot;&quot; a + bi &quot;&quot;&quot; def _...</p></div></div></a></div><div class="card"> <a href="/posts/zer0ptsCTF-writeup/"><div class="card-body"> <em class="small" data-ts="1689433200" data-df="ll" > Jul 16, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>zer0pts 2023 writeup</h3><div class="text-muted small"><p> zer0ptsCTF 久しぶりに長時間参加した気がする… 前置き　 Project Sekaiで参加してました。結果は18位なのでomgって感じですね。。。 実際参加してる人が少なかった＋メインの人がほぼいなかったのも大きいんですかね… 代わりにMr godがいましてrevを爆速で全部終わらしてました(強すぎる) 残りは、upsolveしたら追加します。。。 SquareRNG...</p></div></div></a></div><div class="card"> <a href="/posts/(copy)/"><div class="card-body"> <em class="small" data-ts="1695999600" data-df="ll" > Sep 30, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>十月初週のupsolve</h3><div class="text-muted small"><p> 十月初週のupsolve 時間的に出れなかったやつ+解けなかったやつのupsolve 時間が許す限り書いてみた。他にもやったけど忘れた… ASISCTF refactor chall #!/usr/bin/env python3 from Crypto.Util.number import * from flag import flag def pgen(nbit): x, ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/cakecft/" class="btn btn-outline-primary" prompt="Older"><p>cakectf 2023</p></a> <a href="/posts/MAPNACTF/" class="btn btn-outline-primary" prompt="Newer"><p>MAPNACTF 2024</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://twitter.com/ringbell_un">kanon</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/writeup/">writeup</a> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/cryptography/">cryptography</a> <a class="post-tag" href="/tags/advent-calendar/">advent_calendar</a> <a class="post-tag" href="/tags/def-con31/">DEF CON31</a> <a class="post-tag" href="/tags/tech/">tech</a> <a class="post-tag" href="/tags/university/">university</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script> <script> $(function() { function updateMermaid(event) { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { const mode = event.data.message; if (typeof mermaid === "undefined") { return; } let expectedTheme = (mode === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* Re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } let initTheme = "default"; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) { initTheme = "dark"; } let mermaidConf = { theme: initTheme /* <default|dark|forest|neutral> */ }; /* Markdown converts to HTML */ $("pre").has("code.language-mermaid").each(function() { let svgCode = $(this).children().html(); $(this).addClass("unloaded"); $(this).after(`<div class=\"mermaid\">${svgCode}</div>`); }); mermaid.initialize(mermaidConf); window.addEventListener("message", updateMermaid); }); </script><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3"></p><button type="button" class="btn btn-primary" aria-label="Update"> </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-PPZFY5DSE3"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-PPZFY5DSE3'); }); </script>
